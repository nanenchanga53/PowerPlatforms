# Power Apps 배열 변수 - Collect
> 변수는 특정 값을 저장 할 수 있는 값의 영역이다. 컨트롤의 속성만으로는 원하는 데이터를 저장하지 못하는 경우가 있을 것이다. 이를 해결하기 위해 변수가 필요하다. 여기서는 앱 모든 영역에서 사용 가능하며 배열 형태로 사용 가능한 여기서는 배열 형태로 사용할 수 있는 Collect에 대해 알아보자


## 선언
> 선언시에는 동작 수식(On이 붙어있는 속성들)에서만 사용이 가능하다.

1. Collect의 값을 정리한 후 다시 선언시에 사용한다. Clear 동작후 Collect의 동작을 실행한다고 보면 된다. 행을 추가할 때는 Json 형식의 하나의 영역을 추가하면 된다.  `ClearCollect(Collect이름, {키값1 : "값1", 키값2 : "값2"})` 

2. Collect로 선언한 이름의 영역에 테이블 형식으로 데이터를 보관한다. `Collect(Collect이름, {키값1 : "값1", 키값2 : "값2"})`

3. 선언시 ','를 계속 늘리면서 행을 추가 가능하다. `Collect(Collect이름, {키값1 : "값1", 키값2 : "값2"},{키값1_2 : "값1", 키값2_2 : "값2"})`

4. 사용시에는 직접 데이터를 입력하는 경우보다는 Power Automate, 외부 연결 데이터의 특정 영역만을 가져와서 사용한다.

```
//Power Automate로 검색된 데이터 가져오기
Collect(
    CompanyData,
     거래처검색.Run(DataCardValue81.Text)
);
```

```
// 연결한 데이터 원본에서 가져오기
Collect(
    CompanyData,
     연결한_데이터_원본_이름
);
```

## 사용

1. 첫번째 행을 가져올 시엔 `First(Collect이름)` 을 사용한다. 이 중 한개의 값을 선택하려면 `First(Collect이름).Key값` 형식으로 사용한다.

2. 마지막 행을 가져올 시엔 `Last(Collect이름)` 을 사용한다. 이 중 한개의 값을 선택하려면 `Last(Collect이름).Key값` 형식으로 사용한다.

3. 중간에 있는 한개의 행을 가져올 시엔 `Index(Collect이름, 숫자)` 형식을 사용한다. '주문서' Collect의 3번째 열을 가져오려면 `Index(주문서,3)` 형태로 사용한다.

## 데이터 삭제

- Collect 안에 적재된 모든 데이터 삭제시에는 `clear(Collect이름)` 형식으로 Collect 안의 데이터를 삭제한다.

